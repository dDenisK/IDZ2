const MS_PER_DAY = 1000 * 60 * 60 * 24; // –ö—ñ–ª—å–∫—ñ—Å—Ç—å –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥ —É –¥–Ω—ñ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤

/**
 * –ü–∞—Ä—Å–∏—Ç—å —Å–≤—è—Ç–∫–æ–≤—ñ –¥–Ω—ñ –∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è —É –º–∞—Å–∏–≤ —Ä—è–¥–∫—ñ–≤.
 * @returns {Array<string>} –ú–∞—Å–∏–≤ —Ä—è–¥–∫—ñ–≤ —É —Ñ–æ—Ä–º–∞—Ç—ñ 'YYYY-MM-DD'
 */
function parseHolidays() {
    const text = document.getElementById('holidays').value; // –æ—Ç—Ä–∏–º—É—î–º–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–ª–µ
    const holidayDates = text.split(/[\n,]+/) // —Ä–æ–∑–¥—ñ–ª—è—î–º–æ –∑–∞ –∫–æ–º–∞–º–∏ –∞–±–æ –Ω–æ–≤–∏–º–∏ —Ä—è–¥–∫–∞–º–∏
        .map(s => s.trim()) // –≤–∏–¥–∞–ª—è—î–º–æ –∑–∞–π–≤—ñ –ø—Ä–æ–±—ñ–ª–∏
        .filter(s => s.match(/^\d{4}-\d{2}-\d{2}$/)); // –∑–∞–ª–∏—à–∞—î–º–æ –ª–∏—à–µ –∫–æ—Ä–µ–∫—Ç–Ω—ñ –¥–∞—Ç–∏ —É —Ñ–æ—Ä–º–∞—Ç—ñ 'YYYY-MM-DD'
    return holidayDates; // –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ —á–∏—Å—Ç–∏–π –º–∞—Å–∏–≤ —Ä—è–¥–∫—ñ–≤ —Å–≤—è—Ç–∫–æ–≤–∏—Ö –¥–Ω—ñ–≤
}

/**
 * –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î –¥–∞—Ç–∞ –Ω–µ–¥—ñ–ª–µ—é
 * @param {Date} date
 * @returns {boolean}
 */
function isSunday(date) {
    return date.getDay() === 0; // (0 - –Ω–µ–¥—ñ–ª—è, 6 - —Å—É–±–æ—Ç–∞, —ñ–Ω—à—ñ –¥–Ω—ñ - 1-5)
}

/**
 * –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î –¥–∞—Ç–∞ —Å–≤—è—Ç–∫–æ–≤–∏–º –¥–Ω–µ–º
 * @param {Date} date
 * @param {Array<string>} holidays - –ú–∞—Å–∏–≤ —Ä—è–¥–∫—ñ–≤ 'YYYY-MM-DD'
 * @returns {boolean}
 */
function isHoliday(date, holidays) {
    // –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –æ–±'—î–∫—Ç Date –Ω–∞ —Ä—è–¥–æ–∫ —É —Ñ–æ—Ä–º–∞—Ç—ñ ISO 8601 ("2025-12-15T10:00:00.000Z")
    const dateString = date.toISOString().slice(0, 10); // .slice(0, 10) –æ–±—Ä—ñ–∑–∞—î —Ä—è–¥–æ–∫, –∑–∞–ª–∏—à–∞—é—á–∏ –ª–∏—à–µ –ø–µ—Ä—à—ñ 10 —Å–∏–º–≤–æ–ª—ñ–≤
    return holidays.includes(dateString); // –º–µ—Ç–æ–¥ includes() –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —á–∏ –º—ñ—Å—Ç–∏—Ç—å—Å—è –æ—Ç—Ä–∏–º–∞–Ω–∏–π —Ä—è–¥–æ–∫ dateString —É –º–∞—Å–∏–≤—ñ —Å–≤—è—Ç–∫–æ–≤–∏—Ö –¥–Ω—ñ–≤ holidays
}

/**
 * –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É
 */
function calculateVacation() {
    // –ó—á–∏—Ç—É—é–≤–∞–Ω–Ω—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∑ —Ç—Ä—å–æ—Ö –ø–æ–ª—ñ–≤ –≤–≤–æ–¥—É
    const startDateInput = document.getElementById('startDate').value;
    const endDateInput = document.getElementById('endDate').value;
    const durationInput = document.getElementById('duration').value;
    const holidays = parseHolidays(); // –≤–∏–∫–ª–∏–∫–∞—î–º–æ parseHolidays –¥–ª—è –∑—á–∏—Ç—É–≤–∞–Ω–Ω—è—è —Ç–∞ –æ—á–∏—â–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É —Å–≤—è—Ç–∫–æ–≤–∏—Ö –¥–Ω—ñ–≤
    const output = document.getElementById('resultOutput'); // –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –ø–æ–ª–µ –≤–∏–≤–æ–¥—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
    let warnings = []; // –º–∞—Å–∏–≤ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å (–¥–∞—Ç–∞ –ø–µ—Ä–µ–ø–∞–¥–∞—î –Ω–∞ –Ω–µ–¥—ñ–ª—é)

    // –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö
    let startDate = startDateInput ? new Date(startDateInput) : null; // —è–∫—â–æ —î –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ, —Å—Ç–≤–æ—Ä—é—î–º–æ –æ–±'—î–∫—Ç Date, —ñ–Ω–∞–∫—à–µ null
    let endDate = endDateInput ? new Date(endDateInput) : null; // –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –¥–ª—è –¥–∞—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è
    let duration = durationInput ? parseInt(durationInput) : null; // —è–∫—â–æ —î –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ, –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –Ω–∞ —Ü—ñ–ª–µ —á–∏—Å–ª–æ, —ñ–Ω–∞–∫—à–µ null

    let resultDate, resultDuration; // –∑–º—ñ–Ω–Ω—ñ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É (–¥–∞—Ç–∞ –∞–±–æ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å)
    let calculationMode = 0; // 1: –ó–Ω–∞–π—Ç–∏ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å, 2: –ó–Ω–∞–π—Ç–∏ –ø–æ—á–∞—Ç–æ–∫, 3: –ó–Ω–∞–π—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è

    // –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ä–µ–∂–∏–º—É —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É
    if (startDate && endDate && !durationInput) {
        calculationMode = 1; // –ó–Ω–∞–π—Ç–∏ –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å
    } else if (endDate && duration && !startDateInput) {
        calculationMode = 2; // –ó–Ω–∞–π—Ç–∏ –ü–æ—á–∞—Ç–æ–∫
    } else if (startDate && duration && !endDateInput) {
        calculationMode = 3; // –ó–Ω–∞–π—Ç–∏ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è
    } else {
        output.innerHTML = "üõë –ü–æ–º–∏–ª–∫–∞: –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —Ä—ñ–≤–Ω–æ –¥–≤–∞ –∑ —Ç—Ä—å–æ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ (–î–∞—Ç–∞ –ü–æ—á–∞—Ç–∫—É, –î–∞—Ç–∞ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è, –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å).";
        return;
    }

    // –í–∏–∫–æ–Ω–∞–Ω–Ω—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É
    switch (calculationMode) {
        case 1: // –ó–Ω–∞–π—Ç–∏ –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å (–î–∞—Ç–∞ –ü–æ—á–∞—Ç–∫—É —ñ –î–∞—Ç–∞ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –≤—ñ–¥–æ–º—ñ)
            if (startDate > endDate) {
                output.innerHTML = "üõë –ü–æ–º–∏–ª–∫–∞: –î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø—ñ–∑–Ω—ñ—à–æ—é –∑–∞ –¥–∞—Ç—É –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è.";
                return;
            }
            resultDuration = calculateDuration(startDate, endDate, holidays); // —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É —Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ
            output.innerHTML = `‚úÖ –†–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤–∞ –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: ${resultDuration} ${getNounCase(resultDuration)} (–≤–∫–ª—é—á–Ω–æ).`; // getNounCase –¥–ª—è –≤—ñ–¥–º—ñ–Ω—é–≤–∞–Ω–Ω—è —Å–ª–æ–≤–∞ "–¥–µ–Ω—å"
            break;

        case 2: // –ó–Ω–∞–π—Ç–∏ –ü–æ—á–∞—Ç–æ–∫ (–î–∞—Ç–∞ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —ñ –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –≤—ñ–¥–æ–º—ñ)
            resultDate = calculateStartDate(endDate, duration, holidays);
            output.innerHTML = `‚úÖ –†–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤–∞ –î–∞—Ç–∞ –ü–æ—á–∞—Ç–∫—É: ${formatDate(resultDate)}.`; // formatDate –¥–ª—è —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –¥–∞—Ç–∏ —É –∑—Ä—É—á–Ω–∏–π –≤–∏–≥–ª—è–¥
            break;

        case 3: // –ó–Ω–∞–π—Ç–∏ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è (–î–∞—Ç–∞ –ü–æ—á–∞—Ç–∫—É —ñ –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –≤—ñ–¥–æ–º—ñ)
            resultDate = calculateEndDate(startDate, duration, holidays);
            output.innerHTML = `‚úÖ –†–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤–∞ –î–∞—Ç–∞ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è: ${formatDate(resultDate)}.`; // formatDate –¥–ª—è —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –¥–∞—Ç–∏ —É –∑—Ä—É—á–Ω–∏–π –≤–∏–≥–ª—è–¥
            break;
    }

    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –ù–µ–¥—ñ–ª—é
    const checkStart = calculationMode === 2 ? resultDate : startDate; // –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–∞—Ç–∏ –ø–æ—á–∞—Ç–∫—É –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
    const checkEnd = calculationMode === 3 ? resultDate : endDate; // –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–∞—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏

    // –Ø–∫—â–æ –¥–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É —ñ—Å–Ω—É—î, —ñ –≤–æ–Ω–∞ –ø—Ä–∏–ø–∞–¥–∞—î –Ω–∞ –Ω–µ–¥—ñ–ª—é...
    if (checkStart && isSunday(checkStart)) {
        warnings.push(`–î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É (${formatDate(checkStart)}) –ø—Ä–∏–ø–∞–¥–∞—î –Ω–∞ –Ω–µ–¥—ñ–ª—é.`); // ...–¥–æ–¥–∞—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –¥–æ –º–∞—Å–∏–≤—É
    }
    // –Ø–∫—â–æ –¥–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —ñ—Å–Ω—É—î, —ñ –≤–æ–Ω–∞ –ø—Ä–∏–ø–∞–¥–∞—î –Ω–∞ –Ω–µ–¥—ñ–ª—é...
    if (checkEnd && isSunday(checkEnd)) {
        warnings.push(`–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è (${formatDate(checkEnd)}) –ø—Ä–∏–ø–∞–¥–∞—î –Ω–∞ –Ω–µ–¥—ñ–ª—é.`); // ...–¥–æ–¥–∞—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –¥–æ –º–∞—Å–∏–≤—É
    }

    // –Ø–∫—â–æ –º–∞—Å–∏–≤ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å –Ω–µ –ø–æ—Ä–æ–∂–Ω—ñ–π...
    if (warnings.length > 0) {
        output.innerHTML += `<div class="warning">‚ö†Ô∏è –£–≤–∞–≥–∞:<br>- ${warnings.join('<br>- ')}</div>`; // ...–¥–æ–¥–∞—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –¥–æ –≤–∂–µ —ñ—Å–Ω—É—é—á–æ–≥–æ –≤–∏–≤–æ–¥—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
    }
}

// –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É

/**
 * –†–µ–∂–∏–º 1: –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ –º—ñ–∂ –¥–≤–æ–º–∞ –¥–∞—Ç–∞–º–∏
 * @param {Date} start - –î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É
 * @param {Date} end - –î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è
 * @param {Array<string>} holidays - –ú–∞—Å–∏–≤ —Å–≤—è—Ç–∫–æ–≤–∏—Ö –¥–Ω—ñ–≤
 * @returns {number} –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —É –¥–Ω—è—Ö
 */
function calculateDuration(start, end, holidays) {
    let count = 0; // —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ —Ä–æ–±–æ—á–∏—Ö –¥–Ω—ñ–≤
    let currentDate = new Date(start); // –∫–æ–ø—ñ—è –¥–∞—Ç–∏ –ø–æ—á–∞—Ç–∫—É –¥–ª—è —ñ—Ç–µ—Ä–∞—Ü—ñ—ó

    // –¶–∏–∫–ª —ñ—Ç–µ—Ä—É—î –≤—ñ–¥ –¥–∞—Ç–∏ –ø–æ—á–∞—Ç–∫—É –¥–æ –¥–∞—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –í–ö–õ–Æ–ß–ù–û
    while (currentDate.getTime() <= end.getTime()) {
        // –Ø–∫—â–æ –ø–æ—Ç–æ—á–Ω–∞ –¥–∞—Ç–∞ –Ω–µ —î —Å–≤—è—Ç–∫–æ–≤–∏–º –¥–Ω–µ–º...
        if (!isHoliday(currentDate, holidays)) {
            count++; // ...–∑–±—ñ–ª—å—à—É—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ —Ä–æ–±–æ—á–∏—Ö –¥–Ω—ñ–≤
        }
        currentDate.setTime(currentDate.getTime() + MS_PER_DAY); // –ø–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –¥–µ–Ω—å
    }
    return count; // –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–æ–±–æ—á–∏—Ö –¥–Ω—ñ–≤
}

/**
 * –†–µ–∂–∏–º 3: –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –¥–∞—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è
 * @param {Date} start - –î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É
 * @param {number} duration - –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —É –¥–Ω—è—Ö
 * @param {Array<string>} holidays - –ú–∞—Å–∏–≤ —Å–≤—è—Ç–∫–æ–≤–∏—Ö –¥–Ω—ñ–≤
 * @returns {Date} –î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è
 */
function calculateEndDate(start, duration, holidays) {
    let daysLeft = duration; // —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ –∑–∞–ª–∏—à–∫–æ–≤–∏—Ö –¥–Ω—ñ–≤
    let currentDate = new Date(start); // –∫–æ–ø—ñ—è –¥–∞—Ç–∏ –ø–æ—á–∞—Ç–∫—É –¥–ª—è —ñ—Ç–µ—Ä–∞—Ü—ñ—ó

    // –í—ñ–¥–ª—ñ–∫ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ –¥–∞—Ç–∏ –ø–æ—á–∞—Ç–∫—É
    while (daysLeft > 0) {
        // –Ø–∫—â–æ –ø–æ—Ç–æ—á–Ω–∞ –¥–∞—Ç–∞ –Ω–µ —î —Å–≤—è—Ç–∫–æ–≤–∏–º –¥–Ω–µ–º...
        if (!isHoliday(currentDate, holidays)) {
            daysLeft--; // ...–∑–º–µ–Ω—à—É—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ –∑–∞–ª–∏—à–∫–æ–≤–∏—Ö –¥–Ω—ñ–≤
        }

        // –Ø–∫—â–æ –¥–Ω—ñ –∑–∞–∫—ñ–Ω—á–∏–ª–∏—Å—è, —Ç–æ —Ü–µ —ñ —î –¥–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è
        if (daysLeft === 0) {
            break;
        }

        currentDate.setTime(currentDate.getTime() + MS_PER_DAY); // –ø–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –¥–µ–Ω—å
    }
    return currentDate; // –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –æ–±'—î–∫—Ç Date, —â–æ —î –¥–∞—Ç–æ—é –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è
}

/**
 * –†–µ–∂–∏–º 2: –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –¥–∞—Ç–∏ –ø–æ—á–∞—Ç–∫—É
 * @param {Date} end - –î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è
 * @param {number} duration - –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —É –¥–Ω—è—Ö
 * @param {Array<string>} holidays - –ú–∞—Å–∏–≤ —Å–≤—è—Ç–∫–æ–≤–∏—Ö –¥–Ω—ñ–≤
 * @returns {Date} –î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É
 */
function calculateStartDate(end, duration, holidays) {
    let daysLeft = duration; // —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ –∑–∞–ª–∏—à–∫–æ–≤–∏—Ö –¥–Ω—ñ–≤
    let currentDate = new Date(end); // –∫–æ–ø—ñ—è –¥–∞—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –¥–ª—è —ñ—Ç–µ—Ä–∞—Ü—ñ—ó

    // –í—ñ–¥–ª—ñ–∫ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ –¥–∞—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è
    while (daysLeft > 0) {
        // –Ø–∫—â–æ –ø–æ—Ç–æ—á–Ω–∞ –¥–∞—Ç–∞ –Ω–µ —î —Å–≤—è—Ç–∫–æ–≤–∏–º –¥–Ω–µ–º...
        if (!isHoliday(currentDate, holidays)) {
            daysLeft--; // ...–∑–º–µ–Ω—à—É—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ –∑–∞–ª–∏—à–∫–æ–≤–∏—Ö –¥–Ω—ñ–≤
        }

        // –Ø–∫—â–æ –¥–Ω—ñ –∑–∞–∫—ñ–Ω—á–∏–ª–∏—Å—è, —Ç–æ —Ü–µ —ñ —î –¥–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É
        if (daysLeft === 0) {
            break;
        }

        currentDate.setTime(currentDate.getTime() - MS_PER_DAY); // –ø–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –¥–µ–Ω—å
    }
    return currentDate; // –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –æ–±'—î–∫—Ç Date, —â–æ —î –¥–∞—Ç–æ—é –ø–æ—á–∞—Ç–∫—É
}

// –î–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

// –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î –æ–±'—î–∫—Ç Date —É —Ä—è–¥–æ–∫ —Ñ–æ—Ä–º–∞—Ç—É 'DD.MM.YYYY'
function formatDate(date) {
    // –û–±'—î–∫—Ç options –≤–∏–∑–Ω–∞—á–∞—î, —è–∫ —Å–∞–º–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞—Ç–∏ –¥–∞—Ç—É
    const options = { year: 'numeric', month: '2-digit', day: '2-digit' };
    // toLocaleDateString (–≤–±—É–¥–æ–≤–∞–Ω–∏–π –≤ –æ–±'—î–∫—Ç–∏ Date) –∑ 'uk-UA' –¥–ª—è —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É –¥–∞—Ç–∏
    return date.toLocaleDateString('uk-UA', options);
}

// –í—ñ–¥–º—ñ–Ω—é–≤–∞–Ω–Ω—è —Å–ª–æ–≤–∞ "–¥–µ–Ω—å" –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —á–∏—Å–ª–∞
function getNounCase(number) {
    // '–¥–µ–Ω—å', —è–∫—â–æ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞ 1 (1, 21, 31, ...), –∞–ª–µ –Ω–µ –Ω–∞ 11 (11, 111, ...)
    if (number % 10 === 1 && number % 100 !== 11) return '–¥–µ–Ω—å';
    // '–¥–Ω—ñ', —è–∫—â–æ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞ 2, 3, 4 (2, 23, 24, ...), –∞–ª–µ –Ω–µ –Ω–∞ 12, 13, 14 (12, 113 ...)
    if ([2, 3, 4].includes(number % 10) && ![12, 13, 14].includes(number % 100)) return '–¥–Ω—ñ';
    // '–¥–Ω—ñ–≤' —É –≤—Å—ñ—Ö —ñ–Ω—à–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö (0, 5, 6, 7, 8, 9, –∞ —Ç–∞–∫–æ–∂ —É—Å—ñ –≤–∏–Ω—è—Ç–∫–∏)
    return '–¥–Ω—ñ–≤';
}